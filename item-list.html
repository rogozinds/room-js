<link rel="import"
      href="bower_components/polymer/polymer.html">

<dom-module id="item-list">

    <template>
        <div>Some text</div>
        <img id="img1" src="/resources/dummy.png"  width="40" height="40" draggable="true" onmousedown="get_pos(event)" ondragstart="drag(event)">
    </template>

    <script>
        Polymer({
            is: "item-list",
            ready: function() {
                // set this element's owner property
                this.owner = "Daniel";
            },
            _allowDrop: function(ev) {
                ev.preventDefault();
            },
            get_pos: function (ev){
                pos = [ev.pageX, ev.pageY];
            },
            drag: function(ev) {
                ev.dataTransfer.setData("Text",ev.target.id);
            },

            getPosition: function(element) {
                var xPosition = 0;
                var yPosition = 0;

                while(element) {
                    xPosition += (element.offsetLeft - element.scrollLeft + element.clientLeft);
                    yPosition += (element.offsetTop - element.scrollTop + element.clientTop);
                    element = element.offsetParent;
                }
                return { x: xPosition, y: yPosition };
            },

            drop:function (ev) {
                ev.preventDefault();
                var offset = ev.dataTransfer.getData("text/plain").split(',');
                var data=ev.dataTransfer.getData("Text");

                var img = document.getElementById("img1");
                var dx = pos[0] - getPosition(img)["x"];
                var dy = pos[1] - getPosition(img)["y"];


                var list=img.parentElement.parentElement;
                var item=img.parentElement;
                var c = document.getElementById("myCanvas");

                c.appendChild(img);
                list.removeChild(item);
                document.getElementById("img1").style.position="absolute";
                document.getElementById("img1").style.left=(ev.pageX-dx) +'px';
                document.getElementById("img1").style.top=(ev.pageY-dy)+'px';
            }



        });
    </script>

</dom-module>